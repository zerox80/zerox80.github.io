<!DOCTYPE html>

<html lang="de">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>ACL â€“ Grundlagen</title>
<link href="../../assets/css/style.css" rel="stylesheet"/>
<script defer="" src="../../assets/js/main.js"></script>
<meta content="ACL â€“ Grundlagen" property="og:title"/><meta content="summary" name="twitter:card"/></head>
<body>
<header class="site-header">
<div class="container">
<h1>Linux Lernportal</h1>
<nav class="top-nav">
<a href="../../index.html">Start</a>
<a class="active" href="../index.html">LPIC-1</a>
<a class="disabled" href="#" title="Bald verfÃ¼gbar">LPIC-2</a>
<a class="disabled" href="#" title="Bald verfÃ¼gbar">LPIC-3</a>
<a href="../../search.html">Suche</a><a href="../../lpic-1/glossar.html">Glossar</a><button class="btn" id="themeToggle">ðŸŒ“</button>
</nav>
</div>
</header>
<main class="container">
<div class="breadcrumbs"><a href="../../index.html">Start</a> â–¸ <a href="../index.html">LPICâ€‘1</a> â–¸ <a href="../berechtigungen-acls.html">Berechtigungen &amp; ACLs</a> â–¸ ACL â€“ Grundlagen</div>
<h2>ACL â€“ Grundlagen</h2>
<div class="layout">
<aside class="sidebar card">
<h3>Unterthemen</h3>
<div class="card-body">
<nav class="toc">
<a href="rechte-grundlagen.html">Rechteâ€‘Grundlagen</a>
<a href="chmod-chown-chgrp.html">chmod, chown, chgrp</a>
<a href="umask-und-defaults.html">umask &amp; Defaults</a>
<a href="special-bits-suid-sgid-sticky.html">Special Bits (suid/sgid/sticky)</a>
<a class="active" href="acl-grundlagen.html">ACLâ€‘Grundlagen</a>
<a href="acl-werkzeuge-getfacl-setfacl.html">ACLâ€‘Werkzeuge</a>
<a href="zugriffsstrategien-und-best-practices.html">Best Practices</a>
</nav>
</div>
</aside>
<article class="content">
<div class="card block"><h3>Lernziele</h3><div class="card-body"><ul>
<li>POSIXâ€‘ACL Aufbau erlÃ¤utern: <code>user</code>, <code>group</code>, <code>other</code>, <code>mask</code> und <code>default</code> (fÃ¼r Verzeichnisse).</li>
<li>Effektive vs. nominelle Rechte unterscheiden und aus <code>getfacl</code> korrekt herleiten.</li>
<li>ACLs anlegen, Ã¤ndern, entfernen; Defaultâ€‘ACL fÃ¼r Teamâ€‘Verzeichnisse einrichten.</li>
<li>Interaktion mit klassischen UNIXâ€‘Rechten und <code>umask</code> verstehen.</li>
</ul></div></div>
<div class="card block"><h3>Theorie &amp; Konzepte</h3><div class="card-body">
<h4>POSIXâ€‘ACL Struktur</h4>
<p>Neben den klassischen Rechten (<code>u/g/o</code>) erlauben ACLs feinere Zuweisungen fÃ¼r einzelne Nutzer/Gruppen. Zentrale EintrÃ¤ge:</p>
<ul>
<li><code>user::rwx</code>, <code>group::r-x</code>, <code>other::---</code>: Basisrechte (entsprechen <code>chmod</code> Bits).</li>
<li><code>user:alice:r--</code>, <code>group:dev:rwx</code>: spezifische EintrÃ¤ge.</li>
<li><code>mask::r-x</code>: Obergrenze fÃ¼r alle Gruppenâ€‘ und benutzerÂ­spezifischen EintrÃ¤ge (auÃŸer <code>user::</code>).</li>
<li><code>default:...</code>: Standardâ€‘ACLs auf Verzeichnissen fÃ¼r neu angelegte Objekte.</li>
</ul>
<h4>Effektiv vs. nominell</h4>
<p>Die <em>effektiven</em> Rechte ergeben sich aus <em>nominellen</em> EintrÃ¤gen <strong>gekappt</strong> durch die <code>mask</code>. Beispiel: <code>group:dev:rwx</code> bei <code>mask::r-x</code> fÃ¼hrt effektiv zu <code>r-x</code>.</p>
<h4>Voraussetzungen</h4>
<p>Das Dateisystem muss ACLs unterstÃ¼tzen (bei ext4 Ã¼blich aktiviert). PrÃ¼fen/aktivieren:</p>
<pre><code>tune2fs -l /dev/sda1 | grep "Default mount options"
sudo mount -o remount,acl /mountpoint
</code></pre>
</div></div>
<div class="card block"><h3>Vertiefung: Maskâ€‘Neuberechnung, Vererbung, umask</h3><div class="card-body">
<h4>Maskâ€‘Neuberechnung</h4>
<p>Die <code>mask</code> wird automatisch angepasst, wenn neue ACLâ€‘EintrÃ¤ge mehr Rechte erfordern. Beispiel: Wenn eine Datei <code>mask::r-x</code> hat und du <code>g:dev:rwx</code> setzt, kann das Tool die <code>mask</code> auf <code>rwx</code> anheben <em>oder</em> einen Hinweis ausgeben. PrÃ¼fe nach Ã„nderungen stets die effektiven Rechte.</p>
<pre><code># Beispiel: setfacl hebt die Maske an
setfacl -m g:dev:rwx file
getfacl file  # PrÃ¼fe: mask ggf. jetzt rwx
</code></pre>
<h4>Defaultâ€‘ACL und Vererbung</h4>
<ul>
<li><strong>Defaultâ€‘EintrÃ¤ge</strong> gelten nur auf Verzeichnissen und werden auf neu erzeugte Objekte vererbt.</li>
<li>Die resultierenden ACLs neuer Dateien werden zusÃ¤tzlich durch <code>umask</code> und Anwendungslogik beeinflusst.</li>
<li>Bei rekursiver Anlage in tiefen VerzeichnisbÃ¤umen ist es sinnvoll, Defaultâ€‘ACLs auf der Wurzel korrekt zu setzen.</li>
</ul>
<pre><code># Team-Ordner vorbereiten
sudo mkdir -p /srv/team
sudo chgrp dev /srv/team
sudo chmod 2770 /srv/team     # sgid sorgt fÃ¼r Gruppenerbe
setfacl -d -m g:dev:rwx /srv/team
setfacl -m g:dev:rwx /srv/team
</code></pre>
<h4>Interaktion mit umask</h4>
<p><code>umask</code> definiert Standardrechte bei der Dateierstellung. Defaultâ€‘ACLs wirken <em>zusÃ¤tzlich</em>. Tools/Programme kÃ¶nnen Rechte explizit setzen und damit umask/Defaultâ€‘ACL Ã¼bersteuern. PrÃ¼fe real erzeugte Dateien, nicht nur die Theorie.</p>
<pre><code># Aktuelle umask anzeigen
umask

# Test: Datei erstellen und effektive Rechte prÃ¼fen
touch /srv/team/test.txt
getfacl /srv/team/test.txt
</code></pre>
</div></div>
<div class="card block"><h3>Praxis: getfacl/setfacl</h3><div class="card-body"><pre><code># Aktuelle ACLs anzeigen
getfacl projekt.txt

# Benutzerin Alice Lesezugriff geben
setfacl -m u:alice:r projekt.txt

# Gruppe dev vollen Zugriff geben
setfacl -m g:dev:rwx projekt.txt

# Mask anpassen (sonst kappen!)
setfacl -m m:rwx projekt.txt

# EintrÃ¤ge entfernen
setfacl -x u:alice projekt.txt

# Rekursiv auf Verzeichnis anwenden
setfacl -R -m g:dev:rwx proj/

# Defaultâ€‘ACL fÃ¼r Teamâ€‘Ordner setzen (gilt fÃ¼r neu erstellte Dateien/Ordner)
setfacl -d -m g:dev:rwx proj/

# Defaultâ€‘ACL vollstÃ¤ndig definieren
setfacl -d -m u::rwx,g::rwx,o::---,m:rwx proj/
</code></pre>
<p><strong>Hinweis:</strong> Wenn Resultate nicht wie erwartet sind, zuerst die <code>mask</code> prÃ¼fen. Viele â€žFehlerâ€œ sind Maskâ€‘Effekte.</p>
</div></div>
<div class="card block"><h3>Praxis: ACLs mit rsync/tar sichern</h3><div class="card-body">
<p>ACLs sind <em>nicht</em> automatisch in allen Kopier-/Backupâ€‘Werkzeugen enthalten. Nutze geeignete Flags:</p>
<pre><code># rsync: ACLs und xattrs mitnehmen
rsync -aAXv /src/ /dst/

# tar: ACLs sichern und wiederherstellen (GNU tar)
tar --acls --xattrs -cpf backup.tar /srv/team
tar --acls --xattrs -xpf backup.tar -C /restore

# getfacl/setfacl: ACLs als Text exportieren/importieren
getfacl -R /srv/team &gt; acls.txt
setfacl --restore=acls.txt
</code></pre>
<p>Bei Netzwerkfreigaben (Samba/NFS) sind Serverâ€‘ und Exportâ€‘Optionen entscheidend. PrÃ¼fe, ob ACLâ€‘Erweiterungen auf dem Ziel unterstÃ¼tzt werden.</p>
</div></div>
<div class="card block"><h3>Troubleshooting</h3><div class="card-body">
<ul>
<li><strong>Symptom:</strong> Benutzer in Gruppe <code>dev</code> kann nicht schreiben, obwohl <code>g:dev:rwx</code> gesetzt ist.<br/><em>Check:</em> <code>mask</code> vielleicht <code>r-x</code>. LÃ¶sung: <code>setfacl -m m:rwx FILE</code>.</li>
<li><strong>Symptom:</strong> Neue Dateien sind nicht gruppenteilig.<br/><em>Check:</em> Fehlt <code>sgid</code> auf dem Verzeichnis? <code>chmod 2770 DIR</code>. Defaultâ€‘ACL korrekt?</li>
<li><strong>Symptom:</strong> Nach Kopie via <code>cp</code> fehlen ACLs.<br/><em>Check:</em> Nutze <code>rsync -A</code> oder <code>cp --preserve=all</code> (nicht Ã¼berall identisch implementiert).</li>
<li><strong>Symptom:</strong> NFSâ€‘Share ignoriert ACLs.<br/><em>Check:</em> Exportâ€‘Optionen (<code>acl</code>), Serverâ€‘Kernel, Mountâ€‘Optionen des Clients.</li>
<li><strong>Symptom:</strong> getfacl zeigt â€ž#effectiveâ€œ weniger Rechte.<br/><em>Check:</em> Das sind die <em>effektiven</em> durch die Maske gekappten Rechte â€“ erwartetes Verhalten.</li>
</ul>
</div></div>
<div class="card block"><h3>Best Practices</h3><div class="card-body"><ul>
<li><strong>Gruppenâ€‘First:</strong> Vermeide viele userâ€‘spezifische EintrÃ¤ge; arbeite mit Rollenâ€‘Gruppen.</li>
<li><strong>Defaultâ€‘ACL fÃ¼r Teams:</strong> Auf Projektverzeichnissen Defaultâ€‘ACL setzen, damit neue Dateien automatisch teilbar sind.</li>
<li><strong>Dokumentation:</strong> In README im Projektordner gewÃ¼nschte Rechte/Masks festhalten.</li>
<li><strong>Diagnose:</strong> Immer <code>getfacl</code> auf Datei und Elternverzeichnis prÃ¼fen; <code>mask</code> im Blick behalten.</li>
</ul></div></div>
<div class="card block"><h3>Cheatsheet</h3><div class="card-body"><pre><code># Anzeigen
getfacl FILE|DIR

# Setzen/Ã„ndern
setfacl -m u:alice:rw FILE
setfacl -m g:dev:rwx FILE
setfacl -m m:rwx FILE   # Mask!

# Entfernen
setfacl -x u:alice FILE
setfacl -b FILE         # Alle ACLs lÃ¶schen

# Rekursiv
setfacl -R -m g:dev:rwx DIR

# Defaultâ€‘ACL (nur Verzeichnisse)
setfacl -d -m g:dev:rwx DIR

# Mountâ€‘Check (ext4)
tune2fs -l /dev/sdXN | grep "Default mount options"
</code></pre></div></div>
<div class="card block"><h3>Ãœbungen</h3><div class="card-body"><ol>
<li>Richten Sie in <code>/srv/team</code> eine Defaultâ€‘ACL ein, sodass Gruppe <code>dev</code> immer <code>rwx</code> erhÃ¤lt. Testen Sie mit neu erstellten Dateien.</li>
<li>Geben Sie Benutzerin <code>alice</code> auf <code>report.pdf</code> nur Lesezugriff, aber <code>dev</code> weiterhin <code>rwx</code>. ErklÃ¤ren Sie das Ergebnis, wenn die <code>mask</code> auf <code>r-x</code> steht.</li>
<li>Entfernen Sie alle ACLs auf <code>legacy/</code> und stellen Sie klassische UNIXâ€‘Rechte wieder her.</li>
<li>Migrieren Sie ein Projekt von <code>/old</code> nach <code>/proj</code> und erhalten Sie ACLs und xattrs. Vergleichen Sie danach <code>getfacl -R</code>.</li>
<li>Erstellen Sie eine Troubleshootingâ€‘Checkliste fÃ¼r Ihr Team, die typische ACLâ€‘Fehler in Ihrer Umgebung adressiert.</li>
</ol></div></div>
<div class="card block"><h3>PrÃ¼fungsfragen</h3><div class="card-body"><ol>
<li>Welche Funktion hat der <code>mask</code>â€‘Eintrag bei POSIXâ€‘ACLs?</li>
<li>Wie setzt man eine Defaultâ€‘ACL, die allen Mitgliedern der Gruppe <code>qa</code> Schreibrechte in einem Verzeichnis gewÃ¤hrt?</li>
<li>Warum wirkt sich <code>mask</code> nicht auf <code>user::</code> aus?</li>
</ol></div></div>
<div class="card block"><h3>Quiz</h3><div class="card-body">
<div class="quiz" id="quiz-acl-1">
<div class="quiz-question">Welche Ausgabe entspricht den <em>effektiven</em> Rechten fÃ¼r Gruppe <code>dev</code>, wenn <code>mask::r-x</code> und <code>group:dev:rwx</code> gesetzt sind?</div>
<div class="quiz-options">
<label class="quiz-option" data-correct="1"><input name="q1" type="radio"/> r-x</label>
<label class="quiz-option"><input name="q1" type="radio"/> rwx</label>
<label class="quiz-option"><input name="q1" type="radio"/> r--</label>
</div>
<div class="quiz-actions"><button class="btn primary check-quiz">PrÃ¼fen</button></div>
<div class="quiz-feedback"></div>
</div>
<div class="quiz" id="quiz-acl-2">
<div class="quiz-question">Welche Aussage ist <strong>korrekt</strong> zu Defaultâ€‘ACLs?</div>
<div class="quiz-options">
<label class="quiz-option" data-correct="1"><input name="q2" type="radio"/> Sie gelten nur fÃ¼r neu erzeugte Objekte in einem Verzeichnis.</label>
<label class="quiz-option"><input name="q2" type="radio"/> Sie Ã¼berschreiben immer <code>umask</code> auf Clients.</label>
<label class="quiz-option"><input name="q2" type="radio"/> Sie wirken auch rÃ¼ckwirkend auf bestehende Dateien.</label>
</div>
<div class="quiz-actions"><button class="btn primary check-quiz">PrÃ¼fen</button></div>
<div class="quiz-feedback"></div>
</div>
</div></div>
<div class="card block"><h3>Fortgeschritten: Szenarien &amp; Sicherheit</h3><div class="card-body">
<ul>
<li><strong>Shared Workspaces:</strong> g+s auf Verzeichnissen + Defaultâ€‘ACLs fÃ¼r konsistente Teamrechte.</li>
<li><strong>TemporÃ¤re Freigaben:</strong> ACLs mit Ablaufdatum dokumentieren und automatisiert wieder entfernen.</li>
<li><strong>Netzwerkâ€‘Shares:</strong> PrÃ¼fe SMB/NFSâ€‘Serverâ€‘Optionen (ACLâ€‘Support). Auf SMB kann das POSIXâ€‘ACLâ€‘Mapping abweichen.</li>
<li><strong>Backups/Restore:</strong> Immer ACLs/xattrs sichern (<code>rsync -aAX</code>, <code>tar --acls --xattrs</code>).</li>
</ul>
</div></div>
<div class="card block"><h3>ZusÃ¤tzliche Ãœbungen</h3><div class="card-body">
<ol class="exercise-steps">
<li>Erstelle eine Dokumentation, die die gewÃ¼nschten Defaultâ€‘ACLs fÃ¼r ein Projekt definiert und mit <code>setfacl --restore</code> wiederherstellbar macht.</li>
<li>Simuliere Maskâ€‘Probleme: Setze <code>g:dev:rwx</code> und reduziere die <code>mask</code> auf <code>r-x</code>. ErklÃ¤re die resultierenden <em>effektiven</em> Rechte.</li>
<li>PrÃ¼fe auf einem NFSâ€‘Mount, ob ACLs wirksam sind. Falls nicht, untersuche Exportâ€‘ und Mountâ€‘Optionen.</li>
</ol>
</div></div>
<div class="card block"><h3>Zusatzâ€‘Quiz</h3><div class="card-body">
<div class="quiz" id="quiz-acl-3">
<div class="quiz-question">Welche Zeile ergÃ¤nzt eine Defaultâ€‘ACL fÃ¼r Gruppe <code>dev</code> mit <code>rwx</code> auf einem Verzeichnis korrekt?</div>
<div class="quiz-options">
<label class="quiz-option"><input name="q3" type="radio"/> setfacl -m g:dev:rwx DIR</label>
<label class="quiz-option" data-correct="1"><input name="q3" type="radio"/> setfacl -m d:g:dev:rwx DIR</label>
<label class="quiz-option"><input name="q3" type="radio"/> setfacl -x d:g:dev DIR</label>
</div>
<div class="quiz-actions"><button class="btn primary check-quiz">PrÃ¼fen</button><button class="btn reset-quiz">ZurÃ¼cksetzen</button></div>
<div class="quiz-feedback"></div>
</div>
</div></div>
</article>
</div>
<div class="card" id="progressWidget"><div class="card-body"><h3>Kapitel abschlieÃŸen</h3><p class="muted">Hake dieses Kapitel als erledigt ab. Dein Fortschritt wird nur lokal im Browser gespeichert.</p><label class="checkbox"><input id="pageComplete" type="checkbox"/> Ich habe dieses Kapitel verstanden</label><p><a href="../../lpic-1/fortschritt.html">Zu meinem Fortschritt</a></p></div></div><div class="card"><div class="card-body"><h3>Optionenâ€‘Atlas (Kernbefehle)</h3><table><tr><th>Kommando</th><th>Wichtige Optionen</th></tr><tr><td><code>chmod</code></td><td>symbolisch u/g/o/a,+/-/=(rwxXst); oktal 0â€“7; --reference=DATEI</td></tr>
<tr><td><code>chown</code></td><td>USER[:GRUPPE] DATEI; -R rekursiv; --from prÃ¼fen</td></tr>
<tr><td><code>chgrp</code></td><td>GRUPPE DATEI; -R rekursiv</td></tr>
<tr><td><code>setfacl</code></td><td>-m u:NAME:rwX g:GRUPPE:r--; -x Eintrag lÃ¶schen; -b alle ACLs lÃ¶schen; -d Default-ACL</td></tr>
<tr><td><code>getfacl</code></td><td>Effektive Rechte &amp; Mask anzeigen</td></tr>
<tr><td><code>umask</code></td><td>Basis 666/777; mask subtrahiert Bits; hÃ¤ufig 022 oder 027</td></tr></table></div></div><div class="card"><div class="card-body"><h3>Szenarien aus der Praxis</h3><ul><li>Gemeinsamer Teamordner mit Defaultâ€‘ACL fÃ¼r Gruppe proj (rwX).</li>
<li>Sticky-Bit auf geteilten Ordnern (z.â€¯B. /tmp, /shared) gegen versehentliches LÃ¶schen.</li>
<li>Setuidâ€‘Hilfsprogramm: SicherheitsprÃ¼fung und Alternativen (sudo mit NOPASSWD).</li>
<li>Backup-User erhÃ¤lt Leserechte per ACL ohne Gruppenwechsel.</li></ul></div></div><div class="card"><div class="card-body"><h3>Diagnose-Flow (schneller Pfad zur LÃ¶sung)</h3><ol><li>Ownership korrekt? (ls -l)</li>
<li>U/G/Oâ€‘Rechte passend? (chmod)</li>
<li>ACLs vorhanden &amp; Mask? (getfacl)</li>
<li>Sonderbits sinnvoll? (suid/sgid/sticky)</li></ol></div></div><div class="card"><div class="card-body"><h3>Erweiterte Ãœbungen</h3><p>Bearbeite die Aufgaben, dokumentiere die Schritte und vergleiche die Ergebnisse mit den Erwartungen. Nutze eine frische VM fÃ¼r reproduzierbare Ergebnisse.</p><ol><li>Gemeinsamer Teamordner mit Defaultâ€‘ACL fÃ¼r Gruppe proj (rwX). â€“ <em>liefere Befehle, BegrÃ¼ndung und Nachweise (Logs/Outputs)</em>.</li><li>Sticky-Bit auf geteilten Ordnern (z.â€¯B. /tmp, /shared) gegen versehentliches LÃ¶schen. â€“ <em>liefere Befehle, BegrÃ¼ndung und Nachweise (Logs/Outputs)</em>.</li><li>Setuidâ€‘Hilfsprogramm: SicherheitsprÃ¼fung und Alternativen (sudo mit NOPASSWD). â€“ <em>liefere Befehle, BegrÃ¼ndung und Nachweise (Logs/Outputs)</em>.</li><li>Backup-User erhÃ¤lt Leserechte per ACL ohne Gruppenwechsel. â€“ <em>liefere Befehle, BegrÃ¼ndung und Nachweise (Logs/Outputs)</em>.</li></ol></div></div><div class="card"><div class="card-body"><h3>Cheatsheet â€“ erweitert</h3><pre><code># Rechte &amp; ACLs
umask 027
chmod u=rw,g=r,o= datei
chown alice:proj datei
chmod g+s /srv/proj    # sgid
chmod o+t /shared      # sticky
setfacl -m u:alice:rw- -m g:proj:rwX ordner
getfacl ordner</code></pre></div></div><div class="card" id="prevnext"><div class="card-body"><h3>Weiter navigieren</h3><p><a href="acl-werkzeuge-getfacl-setfacl.html" rel="next">NÃ¤chste Seite â†’</a></p></div></div></main>
<footer class="site-footer"><div class="container"><span>Â© Linux Lernportal</span></div></footer>
</body>
</html>
